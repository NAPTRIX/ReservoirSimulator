<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Reservoir Simulator</title>
    <meta name="description" content="Web-based Black Oil Reservoir Simulator using finite-difference numerical methods.">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- React -->
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react@18/umd/react.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons -->
    <link href="https://resource.trickle.so/vendor_lib/unpkg/lucide-static@0.516.0/font/lucide.css" rel="stylesheet">
    
    <!-- Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.9/dist/chart.umd.min.js"></script>
    <script>
        const ChartJS = window.Chart;
    </script>

    <script>
        // Check for file protocol immediately
        window.onload = function() {
            if (window.location.protocol === 'file:') {
                const root = document.getElementById('root');
                if (root && !root.hasChildNodes()) {
                    document.body.innerHTML = `
                        <div style="font-family: sans-serif; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: #f8fafc; color: #334155; padding: 20px; text-align: center;">
                            <div style="background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); max-width: 600px;">
                                <h1 style="color: #ef4444; margin-bottom: 16px; font-size: 24px; font-weight: bold;">⚠️ Local File Access Detected</h1>
                                <p style="margin-bottom: 24px; line-height: 1.6;">
                                    This application uses modern web technologies (React & Babel) that require a web server to function correctly. 
                                    Browsers block external script loading when opening <code>index.html</code> directly via double-click for security reasons (CORS).
                                </p>
                                <div style="background: #f1f5f9; padding: 16px; border-radius: 8px; text-align: left; font-family: monospace; font-size: 14px; margin-bottom: 24px;">
                                    <p style="margin: 0 0 8px 0; color: #64748b; font-weight: bold;">How to run this locally:</p>
                                    <p style="margin: 4px 0;">1. Open terminal/command prompt in this folder</p>
                                    <p style="margin: 4px 0;">2. Run: <span style="color: #2563eb;">python3 -m http.server</span></p>
                                    <p style="margin: 4px 0;">3. Open: <span style="color: #2563eb;">http://localhost:8000</span></p>
                                </div>
                                <button onclick="window.location.reload()" style="background: #2563eb; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 500;">
                                    I'm running a server now, Reload
                                </button>
                            </div>
                        </div>
                    `;
                }
            }
        };
    </script>

    <style type="text/tailwindcss">
    @layer theme {
        :root {
            /* Premium Engineering Dark/Light Mix */
            --primary-dark: #0f172a; 
            --primary-light: #f8fafc;
            
            --accent-blue: #2563eb;
            --accent-blue-hover: #1d4ed8;
            
            --border-subtle: #e2e8f0;
            --border-strong: #cbd5e1;
            
            --text-main: #1e293b;
            --text-muted: #64748b;
            
            --surface-card: #ffffff;
            --surface-bg: #f1f5f9;
        }
    }

    @layer base {
        body {
            @apply bg-[var(--surface-bg)] text-[var(--text-main)];
            font-family: 'Inter', system-ui, sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        /* Specialized font for data */
        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }
    }

    @layer components {
        .btn {
            @apply inline-flex items-center justify-center px-4 py-2 rounded-md font-medium text-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-[var(--accent-blue)];
        }
        .btn-primary {
            @apply bg-[var(--primary-dark)] text-white hover:bg-slate-800 shadow-sm hover:shadow;
        }
        .btn-accent {
            @apply bg-[var(--accent-blue)] text-white hover:bg-[var(--accent-blue-hover)] shadow-sm hover:shadow;
        }
        .btn-secondary {
            @apply bg-white border border-[var(--border-strong)] text-[var(--text-main)] hover:bg-slate-50 hover:border-slate-400;
        }
        .btn-ghost {
            @apply text-[var(--text-muted)] hover:text-[var(--text-main)] hover:bg-slate-100;
        }
        
        .card {
            @apply bg-[var(--surface-card)] border border-[var(--border-subtle)] rounded-lg shadow-sm;
        }
        
        .input-label {
            @apply block text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider mb-1.5;
        }
        .input-field {
            @apply w-full px-3 py-2 bg-slate-50 border border-[var(--border-strong)] rounded text-sm focus:outline-none focus:border-[var(--accent-blue)] focus:ring-1 focus:ring-[var(--accent-blue)] transition-colors;
        }
    }
    </style>
</head>
<body>
    <div id="root">
        <div class="h-screen w-full flex items-center justify-center text-slate-400 gap-2">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-current"></div>
            <span>Loading Simulator Environment...</span>
        </div>
    </div>
    <!-- Load pure JS engines normally -->
    <script src="utils/LinearAlgebra.js"></script>
    <script src="utils/SimulatorEngine.js"></script>
    <!-- Load React Components via Babel -->
    <script type="text/babel" src="components/Header.js"></script>
    <script type="text/babel" src="components/Sidebar.js"></script>
    <script type="text/babel" src="components/SettingsModal.js"></script>
    <script type="text/babel" src="components/DocumentationModal.js"></script>
    <script type="text/babel" src="components/GridVisualizer.js"></script>
    <script type="text/babel" src="components/ProductionCharts.js"></script>
    <script type="text/babel" src="app.js"></script>
</body>
</html>